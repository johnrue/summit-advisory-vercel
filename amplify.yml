version: 1
frontend:
  phases:
    preBuild:
      commands:
        - npx pnpm install
    build:
      commands:
        - npx pnpm run build # This executes 'next build'
  artifacts:
    # For Next.js 13+ with App Router, the build output is in the .next directory.
    # AWS Amplify's Next.js compute provider typically handles SSR/SSG deployments correctly
    # by referencing the .next directory.
    baseDirectory: .next
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
      - .next/cache/**/*
